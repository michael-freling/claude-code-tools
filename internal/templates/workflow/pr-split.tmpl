CRITICAL: Your response MUST be ONLY valid JSON. Do NOT include any markdown, explanations, analysis, or text outside the JSON object.
DO NOT include any explanations, analysis, or markdown commentary.
DO NOT wrap JSON in code blocks (no ```).
Your entire response must be the raw JSON object starting with { and ending with }.

IMPORTANT: The following context is for your analysis ONLY. DO NOT output any commentary about this context.
Your ONLY output must be the JSON object following the schema at the end of this prompt.

You need to split the current changes into multiple pull requests for easier review.

## Change Metrics
- Lines Changed: {{.Metrics.LinesChanged}}
- Files Changed: {{.Metrics.FilesChanged}}

{{if .Metrics.FilesAdded}}
### Files Added
{{range .Metrics.FilesAdded}}- {{.}}
{{end}}
{{end}}

{{if .Metrics.FilesModified}}
### Files Modified
{{range .Metrics.FilesModified}}- {{.}}
{{end}}
{{end}}

{{if .Metrics.FilesDeleted}}
### Files Deleted
{{range .Metrics.FilesDeleted}}- {{.}}
{{end}}
{{end}}

## Commits to Split

The following commits need to be distributed across child PRs:

{{range .Commits}}
- `{{.Hash}}` - {{.Subject}}
{{end}}

## Split Strategy

Choose one of the following strategies:

### Strategy: "commits" (Recommended)
Use when commits are logically separable. Each child PR will cherry-pick specific commits.
- Best for: Clean commit history where each commit belongs to one logical change
- Each commit should only appear in ONE child PR

### Strategy: "files"
Use when commits touch multiple concerns. Each child PR will include specific files.
- Best for: Mixed commits that touch multiple features
- A file should only appear in ONE child PR

## Task Instructions
1. Analyze the changes and identify logical groups
2. Create a parent PR that will track the overall feature
3. Split changes into child PRs that:
   - Are independently reviewable
   - Have clear boundaries
   - Can be merged sequentially
   - Each address a specific aspect of the change

## Guidelines for Splitting
- Each child PR should be independently reviewable
- Child PRs are chained: Child 2 is based on Child 1, Child 3 on Child 2, etc.
- All commits/files must be accounted for (no duplicates, no missing)
- Order child PRs by dependency: foundational changes first
- Group changes by logical boundaries such as:
  - By subproject or module (if monorepo)
  - By change type (refactoring vs feature additions vs bug fixes)
  - By domain or feature area
  - By dependency order (foundational changes before dependent ones)
- Keep related changes together even if they span multiple files
- Prioritize reviewability and logical cohesion over arbitrary size limits

## Verification Process
After you create the PRs:
1. Pre-commit hooks will run on each child PR
2. CI will run on each child PR
3. For child PRs 1 to N-1: e2e tests are skipped (partial implementation)
4. For the LAST child PR: ALL tests must pass including e2e tests
5. If any check fails, you will receive the errors and must fix them
6. The parent PR should be empty (just a target branch)

Ensure each child PR:
- Is self-contained and can be reviewed independently
- Passes all linting and formatting checks
- Builds successfully
- Unit and integration tests pass
- The LAST child PR must pass e2e tests

## Required JSON Response Format

Your entire response must be valid JSON matching this exact schema:

{
  "strategy": "commits",
  "parentTitle": "Parent PR: [overall description]",
  "parentDescription": "This PR is split into child PRs for easier review:\n- Child 1: ...\n- Child 2: ...",
  "childPRs": [
    {
      "title": "[Part 1/N] Descriptive title",
      "description": "## Summary\n...\n\n## Changes\n...",
      "commits": ["abc123", "def456"],
      "files": []
    },
    {
      "title": "[Part 2/N] Another title",
      "description": "...",
      "commits": ["ghi789"],
      "files": []
    }
  ],
  "summary": "Brief explanation of why this split makes sense"
}

For "files" strategy, use files array instead of commits:

{
  "strategy": "files",
  "parentTitle": "Parent PR: [overall description]",
  "parentDescription": "This PR is split into child PRs for easier review:\n- Child 1: ...\n- Child 2: ...",
  "childPRs": [
    {
      "title": "[Part 1/N] Descriptive title",
      "description": "## Summary\n...\n\n## Changes\n...",
      "commits": [],
      "files": ["path/to/file1.go", "path/to/file2.go"]
    }
  ],
  "summary": "Brief explanation of why this split makes sense"
}

CRITICAL FINAL REMINDER:
- Output ONLY the raw JSON object
- NO markdown code blocks (no ```)
- NO explanatory text before or after the JSON
- NO conversational responses
- Your response must start with { and end with }
